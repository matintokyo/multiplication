:root{--bg:#f6f9fc;--card:#fff;--accent:#3b82f6;--accent-2:#06b6d4;--text:#09203f}
*{box-sizing:border-box}html,body{height:100%}body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;background:linear-gradient(180deg,#e6f0ff 0%,var(--bg)100%);color:var(--text);-webkit-font-smoothing:antialiased}
.screen{max-width:520px;width:min(520px,96vw);margin:16px auto;padding:12px}
.lead{margin-top:0;color:#334155}
.tables{display:flex;flex-wrap:wrap;gap:8px;margin:12px 0}
.tables button{flex:1 1 20%;min-width:40px;padding:10px;border-radius:10px;border:1px solid #e2e8f0;background:#fff;font-weight:600}
.tables button.selected{background:var(--accent);color:#fff;border-color:transparent}
.controls{margin-top:12px}
.treasure{background:linear-gradient(180deg,#fff,#f8fafc);border-radius:10px;padding:10px;margin-bottom:12px;border:1px solid #e6eef8;position:relative}
.treasure h2{margin:0 0 8px 0;font-size:16px}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(48px,1fr));gap:8px}
.card{background:#fff;border-radius:8px;padding:10px;text-align:center;border:1px solid #e2e8f0;min-height:56px;display:flex;flex-direction:column;justify-content:center;align-items:center}
.card.locked{filter:grayscale(100%);opacity:0.5}
.card .emoji{font-size:24px}
.card .label{font-size:12px;margin-top:6px}
.treasure-actions{position:absolute;right:10px;bottom:8px}
.reset-btn{background:#fff;border:1px solid #e2e8f0;padding:6px 10px;border-radius:8px;font-size:13px}
.treasure-reset{margin-top:8px;text-align:right}
.primary{display:block;width:100%;padding:12px;border-radius:10px;border:0;background:var(--accent);color:#fff;font-size:16px}
.hidden{display:none}
.hud{display:flex;justify-content:space-between;align-items:center;padding:8px}
.chip{background:#fff;padding:8px 12px;border-radius:999px;border:1px solid #e2e8f0}
.problem{font-size:38px;font-weight:700;text-align:center;padding:14px;margin:12px 0;background:var(--card);border-radius:12px}
.answer{min-height:48px;font-size:26px;text-align:center;padding:8px;margin-bottom:12px;border-radius:8px;background:#fff;border:1px solid #e6edf7}
.keypad{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.key{padding:14px;font-size:18px;border-radius:10px;background:#fff;border:1px solid #e2e8f0;text-align:center;font-weight: 500;}
.key.wide{grid-column:span 2}
.column{display: inline-block;width: 40px;text-align: left;}
.short-column{display: inline-block;width: 25px;text-align: left;}
.long-column{display: inline-block;width: 100px;text-align: left;}
.result-details{margin-top:12px;background:#fff;padding:12px;border-radius:10px;border:1px solid #e2e8f0;font-weight: 500;}
.result-actions{display:flex;gap:8px;margin-top:12px}
button:active{transform:translateY(1px)}
@media(min-width:640px){body{padding:24px}.screen{margin-top:48px}}

/* Small screen adjustments */
@media(max-width:420px){
	.screen{padding:10px}
	.problem{font-size:30px}
	.answer{font-size:22px}
	.key{padding:12px;font-size:17px}
	.tables button{padding:8px;font-size:14px}
}
@media(max-width:360px){
	.cards{grid-template-columns:repeat(auto-fit,minmax(40px,1fr));gap:6px}
	.card{min-height:48px;padding:8px}
	.card .emoji{font-size:20px}
	.problem{font-size:26px}
	.answer{font-size:20px}
	.key{padding:10px;font-size:16px;}
}

/* Animation overlay */
.animation-screen{position:fixed;inset:0;align-items:center;justify-content:center;background:transparent;z-index:60;pointer-events:none}
.animation-screen.hidden{display:none !important}
.animation-screen:not(.hidden){display:flex;pointer-events:auto}

/* Modal (on-screen confirmation) */
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.35);z-index:80}
.modal.hidden{display:none}
.modal-content{background:#fff;padding:14px;border-radius:12px;max-width:92%;box-shadow:0 12px 36px rgba(2,6,23,0.2);color:var(--text)}
.modal-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}
.modal .primary{padding:8px 12px;border-radius:8px;display:inline-block;width:auto;background:var(--accent);color:#fff;border:0}
.modal button{border:1px solid #e2e8f0;background:#fff;padding:8px 10px;border-radius:8px}
.game-btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:0;font-weight:700;font-size:16px;box-shadow:0 6px 18px rgba(2,6,23,0.08);cursor:pointer}
.game-btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff}
.game-btn.secondary{background:#fff;border:1px solid #e6edf7;color:var(--text)}
.game-btn:active{transform:translateY(1px)}
.result-actions{display:flex;gap:10px;justify-content:center;margin-bottom:10px}
.animation-content{background:transparent;padding:20px;border-radius:12px;text-align:center;color:var(--text)}
.confetti{position:fixed;top:-10%;font-size:26px;pointer-events:none;opacity:0.95;animation:fall 2600ms linear forwards}
@keyframes fall{to{transform:translateY(120vh) rotate(360deg);opacity:1}}
.celebrate-burst{font-size:48px;animation:pop 900ms ease-out}
@keyframes pop{0%{transform:scale(0.3);opacity:0}60%{transform:scale(1.15);opacity:1}100%{transform:scale(1)}}
.fail-shake{font-size:56px;color:#ff6b6b;animation:shake 900ms ease-in-out}
@keyframes shake{0%{transform:translateX(0)}20%{transform:translateX(-12px)}40%{transform:translateX(12px)}60%{transform:translateX(-8px)}80%{transform:translateX(8px)}100%{transform:translateX(0)}}

/* Unlock pulse animation for card */
.card-unlock{animation:unlockPulse 1200ms cubic-bezier(.2,.8,.2,1);box-shadow:0 8px 24px rgba(59,130,246,0.18);transform-origin:center}
@keyframes unlockPulse{0%{transform:scale(0.6);filter:drop-shadow(0 0 0 rgba(0,0,0,0))}40%{transform:scale(1.18);filter:drop-shadow(0 8px 20px rgba(59,130,246,0.18))}70%{transform:scale(0.98)}100%{transform:scale(1)}}

/* Progress track: small horizontal strip with 20 obstacles and a ninja that moves across */
.progress-track{width:100%;height:56px;display:block;background:linear-gradient(90deg,rgba(0,0,0,0.02),transparent);border-radius:8px;padding:6px 8px;box-sizing:border-box;margin-bottom:8px}
.progress-track-inner{position:relative;height:100%;display:flex;align-items:center}
.track-obstacle{width:2.5%;min-width:6px;height:14px;background:#e2e8f0;border-radius:4px;margin:0 1%;opacity:0.95;transition:background .28s, transform .28s;display:flex;align-items:center;justify-content:center;font-size:12px}
.track-obstacle.cleared-correct{background:var(--accent);transform:translateY(-4px)}
.track-obstacle.cleared-wrong{background:#ef4444;transform:translateY(-4px)}
.track-obstacle.track-goal{background:transparent}
.track-obstacle.track-goal::after{content:'üèÜ';font-size:18px}
.ninja{position:absolute;top:6px;transform:translate(-50%,0);font-size:22px;transition:left 360ms cubic-bezier(.22,.9,.32,1), transform .25s;will-change:left}
.ninja.jump{transform:translate(-50%,-18px) scale(1.06)}

@media(max-width:420px){
	.progress-track{height:48px}
	.ninja{font-size:20px}
}

